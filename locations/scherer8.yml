---
location: scherer8
location_nice: Schererstr 8
latitude: 52.548155118357563
longitude: 13.366984426975247

contact_nickname: "Perry"
contacts:
  - "isprotejesvalkata [attt] gmail com"

hosts:
  - hostname: scherer8
    role: corerouter
    model: "ubnt_edgerouter-x-sfp_24_10"
    poe_on: [0, 1, 2, 3]
    host__rclocal__to_merge:
      - |
        # untag DHCP on ports 0, 3, 4, temove from 1 and 2
        uci set network.vlan_10.ports='eth0:u eth3:u eth4:u eth5:t'
        # untag vlan 201 on port 1
        uci set network.vlan_201.ports='eth1:u'
        # untag vlan 202 on port 2
        uci set network.vlan_202.ports='eth2:u'
        uci commit network
        # add scherer8-wetter to the olsrd service
        uci -q get olsrd.@LoadPlugin[1].service > /dev/null
        if [ "1" -eq $? ]; then
          uci add_list olsrd.@LoadPlugin[1].service='https://scherer8-wetter.ff:443|tcp|Scherer8-Wetter'
          uci commit olsrd
          /etc/init.d/olsrd restart
        fi
        # add static leases and modify dhcp setup
        uci set dhcp.dhcp_dhcp.start=50
        uci set dhcp.dhcp_dhcp.leasetime=15m
        uci -q get dhcp.@host[3].mac > /dev/null
        if [ "1" -eq $? ]; then
          # buildbot1
          uci set dhcp.@host[3].mac='52:54:00:65:49:53'
          uci set dhcp.@host[3].dns=1
          # buildbot2
          uci set dhcp.@host[4].mac='52:54:00:25:5f:9e'
          uci set dhcp.@host[4].dns=1
          # transparenttor
          uci set dhcp.ttor=host
          uci set dhcp.ttor.name=ttor
          uci set dhcp.ttor.ip=10.230.229.9
          uci set dhcp.ttor.mac='52:54:00:b7:91:81'
          uci set dhcp.ttor.dns=1
          # automaton
          uci set dhcp.automaton=host
          uci set dhcp.automaton.name=automaton
          uci set dhcp.automaton.ip=10.230.229.11
          uci set dhcp.automaton.mac='98:fa:9b:84:eb:e0'
          uci set dhcp.automaton.dns=1
          # mwan
          uci set dhcp.mwan=domain
          uci set dhcp.mwan.name='mwan'
          uci set dhcp.mwan.ip=10.230.229.11
        fi
        uci commit dhcp
        /etc/init.d/dnsmasq restart
        reload_config

snmp_devices:
  - hostname: scherer8-perleberger36
    address: 10.230.226.226
    snmp_profile: airos_8

  - hostname: scherer8-bht
    address: 10.230.226.230
    snmp_profile: airos_8

ipv6_prefix: "2001:bf7:750:2e00::/56"

# got following prefixes:
# Router:
#          2001:bf7:750:2e00::/56
# --DHCP:  10.230.229.0/24
# --MESH:  10.230.229.211/32 - meshlan on vlan 211
# --MESH:  10.230.226.224/27
#          -  10.230.226.224/30 - perleberger36
#          -  10.230.226.228/30 - bht

networks:
  # MESH - PTMP / PTP Links
  - vid: 201
    role: mesh
    name: perleberger36
    prefix: 10.230.226.224/30
    ipv6_subprefix: 1
    assignments:
      scherer8: 1
      scherer8-perleberger36: 2

  - vid: 202
    role: mesh
    name: bht
    prefix: 10.230.226.228/30
    ipv6_subprefix: 2
    assignments:
      scherer8: 1
      scherer8-bht: 2

  - vid: 211
    role: mesh
    name: meshlan
    prefix: 10.230.226.211/32
    ipv6_subprefix: 11

  # DHCP
  - vid: 10
    role: dhcp
    prefix: 10.230.229.0/24
    ipv6_subprefix: 0
    inbound_filtering: false
    enforce_client_isolation: false
    assignments:
      scherer8: 1
      pserver: 3
      scherer8-vmhost: 5
      scherer8-buildbot1: 6
      scherer8-buildbot2: 8
      scherer8-wetter: 10
      scherer8-meshtastic: 23

location__ssh_keys__to_merge:
  - comment: paraparapara
    key: ssh-rsa
      AAAAB3NzaC1yc2EAAAADAQABAAABgQDRKiFXUQTEmREu64NucuYES1mB0aRBuWRkGqR/KPv5+txvdOqTRMbrkVcZ60enbpjNcZjaOljD/L28Gkxl0TiLNAc+5XtvL9JvRCc3PIW3RIvhI06nJw20k+L/m8pBNMAhKmvKHFooBVV4c4UZiGe140KYafne20MZ7LXQXHHoKcikK1PyI1+j44cWhE4UDQz6voqSWVJe/9b5fUdwAwyafwRQYAT75hsaqzlHecWHt3XIW8EjazgIu5dde9ldBoDihVQe0F8kKzks1ncCGX641z9bHcHfZa6r0AJ+eTScKvgSKQuhWW2WcZR7hOO1dXTdiSerJMs3havoqZS13TPpJ9jDNbs35qmWuXZ/He/8M1RT2syUd1ilKreAi6qz7foBPU1cYK3dppXnRrndHDNIJpg0K3Nijj10JtWBvnEtbHghA/T+Vs2eEomMxG5JrzK9JgmaAVoTG0jyEwtvmDfPPXc+89xPCn3wivUOwdchOQZZDDEmtNm0Uhmhe2zUYQE=
      ff-para
