---

location: hacrafu-lanterne
location_nice: Gartenstr. 20, 15345 Petershagen/Eggersdorf
latitude: 52.53615
longitude: 13.81818
altitude: 71.5
height: 12.5
contact_name: "Hacken Craften Funken e.V."
contact_nickname: "HaCraFu e.V."
contacts:
  - "freifunk@hacrafu.de"
  - "https://hacrafu.de/freifunk"

hosts:
  - hostname: hacrafu-lanterne
    role: corerouter
    model: "glinet_gl-mt6000"
    wireless_profile: freifunk_hacrafu
    host__rclocal__to_merge:
      - |
        uci set network.vlan_40.ports='lan1:u lan2:t lan3:t lan4:t lan5:t'
        uci set network.vlan_50.ports='eth1:u'
        uci commit network; reload_config

  - hostname: hacrafu-lanterne-ap
    role: ap
    model: "cudy_ap3000outdoor-v1"
    wireless_profile: freifunk_hacrafu_ap_only

  - hostname: hacrafu-lanterne-mesh
    role: ap
    model: "cudy_ap3000outdoor-v1"
    wireless_profile: mesh_only

snmp_devices:
  - hostname: hacrafu-lanterne-north
    address: 10.248.77.68
    snmp_profile: airos_8

  - hostname: hacrafu-lanterne-east
    address: 10.248.77.69
    snmp_profile: airos_8

  - hostname: hacrafu-lanterne-south
    address: 10.248.77.70
    snmp_profile: airos_8

  - hostname: hacrafu-lanterne-west
    address: 10.248.77.71
    snmp_profile: airos_8

airos_dfs_reset:
  - name: "hacrafu-lanterne-north"
    target: "10.248.77.68"
    username: "ubnt"
    password: "file:/root/pwd.txt"
    daytime_limit: "2-7"

  - name: "hacrafu-lanterne-east"
    target: "10.248.77.69"
    username: "ubnt"
    password: "file:/root/pwd.txt"
    daytime_limit: "2-7"

  - name: "hacrafu-lanterne-south"
    target: "10.248.77.70"
    username: "ubnt"
    password: "file:/root/pwd.txt"
    daytime_limit: "2-7"

  - name: "hacrafu-lanterne-west"
    target: "10.248.77.71"
    username: "ubnt"
    password: "file:/root/pwd.txt"
    daytime_limit: "2-7"

ipv6_prefix: "2001:bf7:850:4800::/56"
# dhcp    10.248.77.0/26
# mesh    10.248.81.16/28
# MGMT    10.248.77.64/28
# TUNNEL  10.248.76.114/31

networks:
  # MESH NORTH
  - vid: 10
    role: mesh
    name: mesh_north
    prefix: 10.248.81.17/32
    ipv6_subprefix: -10

  # MESH EAST
  - vid: 11
    role: mesh
    name: mesh_east
    prefix: 10.248.81.18/32
    ipv6_subprefix: -11

  # MESH SOUTH
  - vid: 12
    role: mesh
    name: mesh_south
    prefix: 10.248.81.19/32
    ipv6_subprefix: -12

  # MESH WEST
  - vid: 13
    role: mesh
    name: mesh_west
    prefix: 10.248.81.20/32
    ipv6_subprefix: -13

  # MESH - 5 GHz 802.11s
  - vid: 20
    role: mesh
    name: mesh_5g
    prefix: 10.248.81.21/32
    ipv6_subprefix: -20
    mesh_ap: hacrafu-lanterne
    mesh_radio: 11a_standard
    mesh_iface: mesh

  # MESH - 2.4 GHz 802.11s
  - vid: 21
    role: mesh
    name: mesh_2g
    prefix: 10.248.81.22/32
    ipv6_subprefix: -21
    mesh_ap: hacrafu-lanterne
    mesh_radio: 11g_standard
    mesh_iface: mesh

  # MESH - 5 GHz 802.11s - ap dhcp
  - vid: 22
    role: mesh
    name: mesh_5g_ap
    prefix: 10.248.81.23/32
    ipv6_subprefix: -22
    mesh_ap: hacrafu-lanterne-ap
    mesh_radio: 11a_standard
    mesh_iface: mesh

  # MESH - 2.4 GHz 802.11s - ap dhcp
  - vid: 23
    role: mesh
    name: mesh_2g_ap
    prefix: 10.248.81.24/32
    ipv6_subprefix: -23
    mesh_ap: hacrafu-lanterne-ap
    mesh_radio: 11g_standard
    mesh_iface: mesh

  # MESH - 5 GHz 802.11s - ap mesh
  - vid: 24
    role: mesh
    name: mesh_5g_mesh
    prefix: 10.248.81.25/32
    ipv6_subprefix: -24
    mesh_ap: hacrafu-lanterne-mesh
    mesh_radio: 11a_standard
    mesh_iface: mesh

  # MESH - 2.4 GHz 802.11s - ap mesh
  - vid: 25
    role: mesh
    name: mesh_2g_mesh
    prefix: 10.248.81.26/32
    ipv6_subprefix: -25
    mesh_ap: hacrafu-lanterne-mesh
    mesh_radio: 11g_standard
    mesh_iface: mesh

  # DHCP
  - vid: 40
    role: dhcp
    inbound_filtering: true
    enforce_client_isolation: true
    prefix: 10.248.77.0/26
    ipv6_subprefix: 0
    assignments:
      hacrafu-lanterne: 1

  # MGMT
  - vid: 42
    role: mgmt
    prefix: 10.248.77.64/28
    gateway: 1
    dns: 1
    ipv6_subprefix: 1
    assignments:
      hacrafu-lanterne: 1        # 65
      hacrafu-lanterne-ap: 2     # 66
      hacrafu-lanterne-mesh: 3   # 67
      hacrafu-lanterne-north: 4  # 68
      hacrafu-lanterne-east: 5   # 69
      hacrafu-lanterne-south: 6  # 70
      hacrafu-lanterne-west: 7   # 71

  # Uplink
  - vid: 50
    role: uplink

  - role: tunnel
    ifname: ts_wg0
    mtu: 1280
    prefix: 10.248.76.114/32
    wireguard_port: 51820

  - role: tunnel
    ifname: ts_wg1
    mtu: 1280
    prefix: 10.248.76.115/32
    wireguard_port: 51821

# AP-id, wifi-channel, bandwidth, txpower
location__channel_assignments_11a_standard__to_merge:
  hacrafu-lanterne-ap: 44-40
  hacrafu-lanterne-mesh: 36-40

# AP-id, wifi-channel, bandwidth, txpower
location__channel_assignments_11g_standard__to_merge:
  hacrafu-lanterne-ap: 1-40
  hacrafu-lanterne-mesh: 13-40

# only place this ssh-keys
ssh_keys:
  - comment: Tom
    key: ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAICIpPZouLOf+1WT9ylMa/9mX1dhLTy8W07Q8G5w7KKNz freifunk@hacrafu.de
  - comment: Bob
    key: ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIEHrBKcGS+pyrN4MvRNqg7TPA2EsJ0cDCYLjrDRlTO6k HaCraFu bob@bobgoehler.de
  - comment: Peter
    key: ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIFIzevq2nqgb0rBAEEcDEkAIu24aTiWIkem3+59a6h10 HaCraFu Petersilie
