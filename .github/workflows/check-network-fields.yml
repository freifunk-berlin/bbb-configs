---
name: Check network fields

on: [push, pull_request] # yamllint disable-line rule:truthy

permissions:
  contents: read
  actions: read

jobs:
  check-network-fields:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v5
        with:
          fetch-depth: 0

      - name: Run network fields check
        run: |
          git fetch origin main
          changed_files=$(git diff --name-only origin/main)
          location_files=$(echo "$changed_files" | grep -E '^locations/.*\.yml$' || true)
          if [ -z "$location_files" ]; then
            echo "No location files changed, running against all locations"
            bash ./.github/checks/check-network-fields.sh
          else
            echo "Running check on changed location files"
            bash ./.github/checks/check-network-fields.sh "$location_files"
          fi
